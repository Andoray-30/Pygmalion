# ═══════════════════════════════════════════════════════════════
# Pygmalion AI 项目配置文件
# 复制此文件为 .env 并根据需要修改
# ═══════════════════════════════════════════════════════════════

# ─────────────────────────────────────────────────────────────────
# 核心系统配置
# ─────────────────────────────────────────────────────────────────

# 项目名称和版本
PROJECT_NAME=Pygmalion
PROJECT_VERSION=1.0.0

# 环境设置 (development, production, testing)
ENVIRONMENT=development

# ─────────────────────────────────────────────────────────────────
# Web UI 服务器配置
# ─────────────────────────────────────────────────────────────────

# Flask 应用设置
FLASK_APP=web/app_socketio.py
FLASK_ENV=development
DEBUG=True

# 服务器地址和端口
HOST=0.0.0.0
PORT=5000

# 日志级别 (DEBUG, INFO, WARNING, ERROR)
LOG_LEVEL=INFO

# ─────────────────────────────────────────────────────────────────
# 安全设置
# ─────────────────────────────────────────────────────────────────

# Flask 密钥（生产环境必须修改）
SECRET_KEY=your-secret-key-change-this-in-production

# CORS 允许的源（逗号分隔）
CORS_ORIGINS=*

# ─────────────────────────────────────────────────────────────────
# WebSocket / SocketIO 配置
# ─────────────────────────────────────────────────────────────────

# 心跳配置（秒）
SOCKETIO_PING_TIMEOUT=60
SOCKETIO_PING_INTERVAL=25

# 最大连接数
MAX_CONNECTIONS=100

# ─────────────────────────────────────────────────────────────────
# API 密钥和认证
# ─────────────────────────────────────────────────────────────────

# Deepseek API 配置
DEEPSEEK_API_KEY=your-deepseek-key-here
DEEPSEEK_API_URL=https://api.deepseek.com/v1
DEEPSEEK_MODEL=deepseek-chat

# ModelScope API 配置（免费，优先使用）
MODELSCOPE_API_KEY=your-modelscope-key-here
MODELSCOPE_API_URL=https://api.modelscope.cn

# SiliconFlow API 配置（付费，备选方案）
SILICONFLOW_API_KEY=your-siliconflow-key-here
SILICONFLOW_API_URL=https://api.siliconflow.cn

# ─────────────────────────────────────────────────────────────────
# 生成参数配置
# ─────────────────────────────────────────────────────────────────

# 默认参数
DEFAULT_ITERATIONS=5
DEFAULT_TARGET_SCORE=0.8
DEFAULT_QUICK_MODE=false

# 生成范围限制
MIN_ITERATIONS=1
MAX_ITERATIONS=20
MIN_TARGET_SCORE=0.0
MAX_TARGET_SCORE=1.0

# 超时设置（秒）
GENERATION_TIMEOUT=600
API_TIMEOUT=30

# ─────────────────────────────────────────────────────────────────
# 图片和存储配置
# ─────────────────────────────────────────────────────────────────

# 输出目录
IMAGE_OUTPUT_DIR=./web/static/images
HISTORY_OUTPUT_DIR=./evolution_history

# 缓存配置
MAX_IMAGE_CACHE=100
IMAGE_CACHE_TTL=3600

# 图片格式和尺寸
IMAGE_FORMAT=png
IMAGE_QUALITY=95
DEFAULT_IMAGE_SIZE=512

# ─────────────────────────────────────────────────────────────────
# 模型配置
# ─────────────────────────────────────────────────────────────────

# 评分模型轮换
JUDGE_MODEL_ROTATION_ENABLED=true
JUDGE_MODEL_ROTATION_INTERVAL=150

# 生成模型
GENERATION_MODEL=stable-diffusion-xl
GENERATION_DEVICE=cuda  # cuda, cpu, mps

# ─────────────────────────────────────────────────────────────────
# 高级设置
# ─────────────────────────────────────────────────────────────────

# 启用缓存
ENABLE_CACHE=true

# 启用性能监控
ENABLE_METRICS=false

# WebSocket 调试模式
SOCKETIO_DEBUG=false
FORGE_URL=http://127.0.0.1:7860
FORGE_TIMEOUT=90
FORGE_HEARTBEAT_INTERVAL=5

# ------------------------------
# 控制参数
# ------------------------------
TARGET_SCORE=0.90
MAX_ITERATIONS=30
CONVERGENCE_PATIENCE=5
CONVERGENCE_THRESHOLD=0.005

# ------------------------------
# 双模型配置 (🔥 新增)
# ------------------------------
# 双模型配置 (全SDXL方案 - 架构统一，1024×1024端到端)
# 探索模式：SDXL Turbo (1步极速，0.3秒/张)
PREVIEW_MODEL=sd_xl_turbo_1.0_fp16.safetensors

# 渲染模式：Juggernaut XL Ragnarok (5步摄影级，8-10秒/张)  
RENDER_MODEL=juggernautXL_ragnarokBy.safetensors

# 模型切换阈值 (当分数达到此值且进入OPTIMIZE阶段时切换)
MODEL_SWITCH_SCORE_THRESHOLD=0.78

# 最小探索次数 (至少迭代多少次后才允许切换模型)
MODEL_SWITCH_MIN_ITERATIONS=5

# ------------------------------
# 评分模型配置
# ------------------------------
JUDGE_MODEL_NAME=Qwen/Qwen2.5-VL-72B-Instruct
JUDGE_MAX_RETRIES=3
JUDGE_TIMEOUT=30

# ------------------------------
# 创意模型配置
# ------------------------------
DEEPSEEK_MODEL=deepseek-ai/DeepSeek-V3
DEEPSEEK_MAX_RETRIES=5
DEEPSEEK_TIMEOUT=30

# ------------------------------
# 日志配置
# ------------------------------
LOG_LEVEL=INFO
LOG_FILE=pygmalion.log
